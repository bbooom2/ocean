<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
<script>

  function fnFindEmail() {
	  $('#btnFindEmail').on('click', function(){
    	$.ajax({
        type: 'post',
        url: '/users/findEmail.do',
        contentType: 'application/json',  // 보내는 데이터가 JSON이라는 의미입니다. 
        data: JSON.stringify({            // 보내는 데이터의 파라미터 이름이 없기 때문에 컨트롤러에서 parameter를 받는 request.getParameter(), @RequestParam, 커맨드 객체 모두 사용할 수 없습니다.
        	email: $('#email').val()        // 컨트롤러에서는 @RequestBody와 객체 또는 Map을 통해서 받아야 합니다.
        }),
        dataType: 'json',
        success: function(resData) {
          if(resData.findUsers != null) {
            let email = resData.findUsers.email;
            moment.locale('ko-KR');
            $('#findResult').html('회원님의 아이디는 ' + email + '입니다.<br>(가입일 : ' + moment(resData.findUsers.joinedAt).format("YYYY년 MM월 DD일 a h:mm:ss") + ')');
          } else {
        	  $('#findResult').html('일치하는 회원이 없습니다. 입력 정보를 확인하세요.');
          }
        }
      });
    });
  }

  $(function(){
	  fnFindEmail();
	});

</script>
<style>
@font-face {
	    font-family: 'GmarketSansMedium';
	    src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2001@1.1/GmarketSansMedium.woff') format('woff');
	    font-weight: normal;
	    font-style: normal;
		}
	    
        body {
            background-color: #E9E9E9;
          	font-family: 'GmarketSansMedium';
            font-size: 15px;
        }
</style>
</head>
<body>
	  <div>

	    <h1>이메일 찾기</h1>
	
	    <div>
	      <label for="phoneNo">휴대전화</label>
	      <input type="text" name="email" id="email">
	    </div>
	    <div>
	      <input type="button" value="이메일찾기" id="btnFindEmail">
	    </div>
	    <div>
	      <a th:href="@{/users/login.html}">로그인</a> |
	      <a th:href="@{/users/findPw.html}">비밀번호 찾기</a> |
	      <a th:href="@{/users/agree.html}">회원가입</a>
	    </div>
	    
	  </div>
  
  <hr>
  
  <div id="findResult"></div>

</body>
</html>