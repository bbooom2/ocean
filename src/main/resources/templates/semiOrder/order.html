<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{/layout/header::oceanHead('kakaopay실험')}"></head>
<script th:src="@{/js/lib/jquery-3.6.4.min.js}"></script>
<script>
$(function(){
	$("#kakaopayTest").on('sunmit', function(){
		
		// 필수입력값을 확인.
		var name = $("#kakaopayTest input[name='pay-name']").val();
		var tel = $("#kakaopayTest input[name='pay-tel']").val();
		var email = $("#kakaopayTest input[name='pay-email']").val();
		/* 		
		if(name == ""){
			$("#form-payment input[name='pay-name']").focus()
		}
		if(tel == ""){
			$("#form-payment input[name='pay-tel']").focus()
		}
		if(email == ""){
			$("#form-payment input[name='pay-email']").focus()
		} */
		
		// 결제 정보를 form에 저장한다.
		/* 
		let totalPayPrice = parseInt($("#total-pay-price").text().replace(/,/g,''))
		let totalPrice = parseInt($("#total-price").text().replace(/,/g,''))
		let discountPrice = totalPrice - totalPayPrice 
		let usePoint = $("#point-use").val()
		let useUserCouponNo = $(":radio[name='userCoupon']:checked").val() 
		*/
		var totalPayPrice = 100;
		var totalPrice = 100;
		// 카카오페이 결제전송
		$.ajax({
			type:'post'
			,url:'/semiOrder/pay'
			,data:{
				total_amount: totalPayPrice
				,payUserName: name
				,totalPrice:totalPayPrice
				,tel:tel
				,email:email
				
			},
			success : 
				function(resData){
				var url = resData.next_redirect_pc_url
		        	location.href = url;
				}
		})
	})
})
</script>
<body>
	<form action="/semiOrder/pay" method="post" id="kakaopayTest">
		<label>이름</label>
		<input type="text" name="pay-name">
		<label>전화번호</label>
		<input type="tel" name="pay-tel">
		<label>이메일</label>
		<input type="text" name="pay-email">
		
		<button>성공기원</button>
	</form>
	
</body>
</html>