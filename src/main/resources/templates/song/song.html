<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{/layout/header::oceanHead('song')}"></head>
<script th:src="@{/js/lib/jquery-3.6.4.min.js}"></script>
<link rel="stylesheet" type="text/css" th:href="@{/slick/slick.css}"/>
<script type="text/javascript" th:src="@{/slick/slick.min.js}"></script>
<style>
	@font-face {
	    font-family: 'GmarketSansMedium';
	    src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2001@1.1/GmarketSansMedium.woff') format('woff');
	    font-weight: normal;
	    font-style: normal;
	}
	body * {
	    font-family: 'GmarketSansMedium';
	}
	/* slick slider 부분*/
	.wrapper {
		width: 50%;
		display: block;
		margin: auto;		
	}
	.center-slider .slick-slide{
	    height: auto;
	    align-items: center;
	    justify-content: center;
	    transform: scale(0.8, 0.8);
	}
	
	
	.center-slider .slick-slide,
	.center-slider .slick-slide[aria-hidden="true"]:not(.slick-cloned) ~ .slick-cloned[aria-hidden="true"] {
	    transform: scale(0.8, 0.8);
	}
	
	/* Active center slide (You can change anything here for center slide)*/
	.center-slider .slick-center,
	.center-slider .slick-current.slick-active,
	.center-slider .slick-slide[aria-hidden="true"]:not([tabindex="-1"]) + .slick-cloned[aria-hidden="true"] {
	    transform: scale(1.0, 1.0);
	}
	
	.slick-next, .slick-prev{
	    z-index: 5;
	}
	.slick-next{
	    right: 15px;
	}
	.slick-prev{
	    left: 15px;
	}
	
	img {
	    width: 100%;
	    height: 100%;
	}
	
	.bg {
		position: relative;
		width: 1000px;
		height : 110vh;
		margin : auto;
		background: #D9D9D9;
		box-shadow: 2px 6px 10px rgba(0, 0, 0, 0.25);
		border-radius: 25px;
	}
	
    .mood-ment {
	   	width: 300px;
	   	padding : 40px 0 0 15%;
   }
	.search_query {
		display: flex;
		align-items: center;
		justify-content: center;
		gap: 10px;
	    
	}
	
	#q {
	  padding: 0 1em; 
	  border: 0;
	  height: 38px;
	  width: 60%;
	  border-radius: 30px;
	  background-color: white;
	}
	
    table {
        border-collapse: collapse;
        margin: 10px auto;
        width: 70%;
    }
    
    td {
        font-size: 14px;
    }
    
    .imgUrl{
    	width: 60px;
    	height: 60px;
    }
    
    .title-singer {
    	padding-left: 10px;
    }
    .singer {
    	font-size: 12px;
    }
    .music-bar {
    	width: 1200px;
    	background-color: rgba(0, 0, 0, 0.5);
    	height: 180px;
    	
    }

</style>
</head>
<script>
    function fnSportifySearch() {
        $('#searchBtn').click(function() {	    	
            $.ajax({
                url: '/song/spotifysearch.do',
                type: 'GET',
                data: 'q=' + $('#q').val(),
                dataType: 'json',
                success: function(resData) {
                    $('#result').empty();
                    // $('#result').append('검색결과 : ' + resData.total);
                    $.each(resData.songList, function(i, song) {
                    	var str = '<tr class="song-line">'
                        str += '<td><img src="'  + song.imgUrl + '" class="imgUrl">';
                        str += '<td class="title-singer"><div class="title">' + song.title + '</div><div class="singer">' + song.singer + '</div>';
                        str += '<td><audio src="' + song.preview + '" controls></audio>';
	                    $('#result').append(str);
                    });
                }
            });
        });
    }
    
    $(function(){
    	$.ajax({
            url: '/song/recommendsong.do',
            type: 'GET',
            dataType: 'json',
            success: function(resData) {
                $('#randomResult').empty();
                $.each(resData, function(i, song) {
                    var row = $('<tr>');
                    var title_td = $('<td>').append('<div class="title">' + song.title + '</div><div class="singer">' + song.singer + '</div>');
                    var preview_td = $('<td>').append('<audio src="' + song.preview + '" controls></audio>');
                    row.append(title_td, preview_td);
                    table.append(row);
                });
                $('#randomResult').append(table);
            }
        });
    })
    
    function fnRecommendsong() {
		$('#recommendBtn').click(function(){
	        $.ajax({
	            url: '/song/recommendsong.do',
	            type: 'GET',
	            data: 'mood=' + $('#mood').val(),
	            dataType: 'json',
	            success: function(resData) {
	                $('#recommendResult').empty();
	                var table = $('<table>');
	                var tableHeader = '<tr><th>title</th><th>preview</th></tr>';
	                table.append(tableHeader);
	                $.each(resData, function(i, song) {
	                    var row = $('<tr>');
	                    var title_td = $('<td>').append('<div class="title">' + song.title + '</div><div class="singer">' + song.singer + '</div>');
	                    var preview_td = $('<td>').append('<audio src="' + song.preview + '" controls></audio>');
	                    row.append(title_td, preview_td);
	                    table.append(row);
	                });
	                $('#recommendResult').append(table);
	            }
	        });
		})
    }
    $(function(){
    	$('.center-slider').slick({
    		  centerMode: true,
    		  centerPadding: '30px',
    		  slidesToShow: 3,
    		  arrows : false,
    		  speed : 300,
    		  infinite : true,
    		  autoplaySpeed: 4000,
    		  autoplay : true,
    		  responsive: [
    		    {
    		      breakpoint: 768,
    		      settings: {
    		        arrows: false,
    		        centerMode: true,
    		        centerPadding: '20px',
    		        slidesToShow: 3
    		      }
    		    },
    		    {
    		      breakpoint: 480,
    		      settings: {
    		        arrows: false,
    		        centerMode: true,
    		        centerPadding: '20px',
    		        slidesToShow: 1
    		      }
    		    }
    		  ]
    		});
        })
    $(function() {
        fnSportifySearch();
        fnRecommendsong();
    });
    
</script>

<body>
	<h2>ocean's pick</h2>
	<div class="wrapper" data-aos="fade-up" data-aos-delay="800">
        <div class="center-slider">
	            <div><img class="slick-slide" th:src="@{/photo/unnamed-2.jpg}" ></div>
	            <div><img class="slick-slide" th:src="@{/photo/unnamed-3.jpg}" ></div>
	            <div><img class="slick-slide" th:src="@{/photo/unnamed-4.jpg}" ></div>
	            <div><img class="slick-slide" th:src="@{/photo/unnamed-5.jpg}" ></div>
	            <div><img class="slick-slide" th:src="@{/photo/unnamed-6.jpg}" ></div>
	            <div><img class="slick-slide" th:src="@{/photo/unnamed.jpg}" ></div>
	            <div><img class="slick-slide" th:src="@{/photo/unnamed-2.jpg}" ></div>
	            <div><img class="slick-slide" th:src="@{/photo/unnamed-3.jpg}" ></div>
	            <div><img class="slick-slide" th:src="@{/photo/unnamed-4.jpg}" ></div>
	            <div><img class="slick-slide" th:src="@{/photo/unnamed-5.jpg}" ></div>
	            <div><img class="slick-slide" th:src="@{/photo/unnamed-6.jpg}" ></div>
	            <div><img class="slick-slide" th:src="@{/photo/unnamed.jpg}" ></div>
        </div>
    </div>    
	<div class="bg">
		<div><img th:src="@{/photo/mood.svg}" class="mood-ment"></div>
	    <div class="search_query">
	    	<input type="text" id="q" placeholder="오늘은 르세라핌의 UNFORGIVEN 어떤가요?">
	    	<button id="searchBtn">Search</button>
	    </div>
	    <div>
	    	<table>
	    		<tbody id="result">
	    		</tbody>
	    	</table>
	    </div>
	    
	    <form>
		    <select id="mood">
		    	<option value="">선택하세요</option>
		    	<option value="sad">sad</option>
		    	<option value="happy">happy</option>
		    	<option value="chill">chill</option>
		    	<option value="groove">groove</option>
		    	<option value="summer">summer</option>
		    	<option value="romance">romance</option>
		    	<option value="r-n-b">r-n-b</option>
		    	<option value="dance">dance</option>
			</select>
			<input type="button" value="조회" id="recommendBtn">
	    </form>
	    <div id="recommendResult">
	    </div>
	</div>
	<section class="music-bar">
		<table>
			<tbody>
				<tr>
					<td rowspan="2"><!-- 앨범사진 --></td>
					<td><!--  제목 --></td>
					<td rowspan="2"><!-- 이전 곡 --></td>
					<td rowspan="2"><!--  재생버튼 --></td>
					<td rowspan="2"><!--  다음 곡 --></td>
				</tr>
				<tr>
					<td><!--  가수  --></td>
				</tr>
			</tbody>
		</table>
	</section>
</body>
</html>
